# 基础知识

## 1.分布式基础理论

### 1.1 what is distributed system

《分布式系统原理与范型》定义：
“分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统”
分布式系统是建立在网络之上的软件系统

随着互联网的发展，网络应用的规模不断扩大，常规的垂直应用架构已无法应用，分布式服务架构以及流动计算架构势在必行，亟需一个治理系统确保架构有条不紊的演进

如淘宝、京东商城，暴露给用户使用的是一个完整的系统，而实际上是成千上万台机器一同提供商城服务

### 1.2 发展演变

![dubbo-架构](https://cdn.jsdelivr.net/gh/wudg/picgo@master/images/blog/20220208192608.png)


* 单一应用架构：当网站流量很小时，只需一个应用，将所有功能都部署在一起，以减少部署节点和成本。此时，用于简化 CURD 工作量的数据访问框架（ORM）是关键
* 垂直应用架构：互相独立的 MVC，页面修改会导致服务重新部署
* 分布式应用架构：RPC
* 流动计算架构：基于访问压力实时管理集群容量，提高集群利用率

### 1.3 RPC

RPC【Remote Procedure Call】是指远程过程调用，是一种进程间通信方式，是一种技术思想，而不是规范
它允许程序调用另一个地址空间（通常是共享网络的另一台机器上）的过程或函数，而不用程序员显式编码这个远程调用的细节。即程序员无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同

**RPC 基本原理**

![RPC 原理](https://cdn.jsdelivr.net/gh/wudg/picgo@master/images/blog/20220208193715.png)

**实例**
![RPC 实例](https://cdn.jsdelivr.net/gh/wudg/picgo@master/images/blog/20220208193918.png)

**影响 RPC 框架因素**

* 建立 socket 连接效率
* 序列化和反序列化效率

## 2.dubbo 核心概念

### 2.1 简介

Apache Dubbo 是一款高性能、轻量级的开源 Java RPC 框架，它提供了六大核心能力：面向接口代理的高性能RPC调用，智能容错和负载均衡，服务自动注册和发现，高度可扩展能力，运行期流量调度，可视化的服务治理与运维。

* 面向接口代理的高性能RPC调用：提供高性能的基于代理的远程调用能力，服务以接口为粒度，为开发者屏蔽远程调用底层细节。
* 智能负载均衡：内置多种负载均衡策略，智能感知下游节点健康状况，显著减少调用延迟，提高系统吞吐量。
* 服务自动注册与发现：支持多种注册中心服务，服务实例上下线实时感知。
* 高度可扩展能力：遵循微内核+插件的设计原则，所有核心能力如Protocol、Transport、Serialization被设计为扩展点，平等对待内置实现和第三方实现。
* 运行期流量调度：内置条件、脚本等路由策略，通过配置不同的路由规则，轻松实现灰度发布，同机房优先等功能。
* 可视化的服务治理与运维：提供丰富服务治理、运维工具：随时查询服务元数据、服务健康状态及调用统计，实时下发路由策略、调整配置参数。

### 2.2 dubbo 设计架构
![dubbo 设计架构](https://cdn.jsdelivr.net/gh/wudg/picgo@master/images/blog/20220208195832.png)

初始化：
* 提供者-服务注册
* 消费者-服务订阅
* dubbo 容器启动 Provider

异步调用：
* 监听器收集 Provider 和 Consumer 信息
* 消费者-服务发现

同步：
* 服务消费者调用提供者

### 2.3 搭建环境

* zookeeper 安装配置
* dubbo-admin 本地部署

### 2.4 编写 dubbo sample

1. 将服务提供者注册到注册中心
2. 让服务消费者去注册中心订阅服务提供者的服务地址